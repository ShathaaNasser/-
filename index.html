<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø±Ù…Ø¶Ø§Ù† - Ø¬Ø§Ù…Ø¹ Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø±Ø¨ÙŠØ¹ Ø¨Ù† Ø­Ø¨ÙŠØ¨</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');

:root{
  --bg:#f0f4f2;
  --card:#ffffff;
  --accent:#1e8b63;
  --gold:#d4af37;
  --muted:#6b705c;
  --friday:#cfe3d6;
  --header-col:#49876d;
  --first-col:#49876d;
}

html, body{
  height:100%; margin:0;
  font-family:'Amiri', serif;
  background:var(--bg) url('https://www.toptal.com/designers/subtlepatterns/uploads/moroccan-flower.png') repeat;
  background-size:300px;
  color:#000000;
}

.container{
  max-width:1000px; margin:36px auto; padding:20px;
}

.card{
  background:var(--card);
  border-radius:14px;
  padding:22px;
  border:4px solid var(--gold);
  box-shadow:0 8px 24px rgba(0,0,0,0.08);
  position:relative;
  background:url('https://www.toptal.com/designers/subtlepatterns/uploads/moroccan-flower.png') repeat;
  background-size:250px;
  backdrop-filter:blur(3px);
}

.card:before{
  content:"";
  position:absolute;
  top:-10px; left:-10px; right:-10px; bottom:-10px;
  border:3px solid var(--gold);
  border-radius:20px;
  pointer-events:none;
}

h1::before{
  content:"";
  display:block;
  width:160px;
  height:180px;
  margin:0 auto 1px ;
  background: url('./img.png') center/contain no-repeat;
}

h1,h2{
  font-size:28px;
  text-align:center;
  margin-bottom:20px;
  color:var(--accent);
  font-weight:700;
}

table{
  width:100%;
  border-collapse: collapse;
  font-size:16px;
  background:#ffffff;
  border-radius:12px;
  overflow:hidden;
  border:1px solid var(--gold);
}

thead th{
  background:var(--header-col);
  color:#ffffff;
  text-align:center;
  padding:14px;
  font-size:17px;
  border:1px solid #a9a9a9;
}

tbody td{
  padding:14px;
  text-align:center;
  border:1px solid #a9a9a9;
}

tbody tr:nth-child(odd){ background: rgba(211,211,211,0.2); }
tbody tr:nth-child(even){ background: rgba(211,211,211,0.1); }
tbody tr:hover{ background: rgba(211,211,211,0.3); }

tbody td:first-child{
  background:var(--first-col);
  color:#ffffff;
  font-weight:700;
}

tbody tr.friday{ background-color:var(--friday) !important; }

table th:first-child, table td:first-child{ width:150px; }

@media (max-width:700px){
  table{ font-size:14px; }
  thead th, tbody td{ padding:9px; }
  table th:first-child, table td:first-child{ width:130px; }
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  position: sticky;
  top: 0;
  z-index: 10;
  border-radius: 12px 12px 0 0;
  padding: 10px 20px;
}

#saveBtn {
  background: var(--gold);
  border: none;
  padding: 10px 18px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: bold;
  color: #fff;
  font-size: 15px;
  transition: background 0.2s ease;
}

#saveBtn:hover {
  background: #c49b2c;
}

#printBtn {
  background: var(--accent);
  border: none;
  padding: 10px 18px;
  border-radius: 12px;
  cursor: pointer;
  font-weight: bold;
  color: #fff;
  font-size: 15px;
  transition: background 0.2s ease;
  margin-left: 10px;
}

#printBtn:hover {
  background: #397155;
}

.contact-box {
  background: var(--card);
  padding: 8px 15px;
  border: 2px solid var(--gold);
  border-radius: 12px;
  text-align: center;
  color: var(--accent);
  font-size: 15px;
  line-height: 1.5;
  display: inline-block;
  margin-right: auto;
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

#saveMessage {
  color: green;
  font-weight: bold;
  display: none;
  margin-left: 10px;
}

/* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
@media print {
  body * { visibility: hidden; }
  #mainTable, #mainTable * { visibility: visible; }
  #mainTable { position: absolute; top: 0; left: 0; width: 100%; }
}
</style>
</head>

<body>
<div class="container">
  <div class="card">
    <div class="card-header">
      <div>
        <button id="saveBtn">ğŸ’¾ Ø­ÙØ¸</button>
        <span id="saveMessage">ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ…</span>
      </div>
      <div>
        <button id="printBtn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
      </div>
      <div class="contact-box">
        <strong> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹:</strong><br/>
        ÙÙŠØµÙ„ Ø§Ù„Ù…Ø¨Ø³Ù„ÙŠ: 98036047<br/>
        Ø¯Ø§ÙˆÙˆØ¯ Ø§Ù„Ù…Ø¨Ø³Ù„ÙŠ: 95522897
      </div>
    </div>

    <h1>Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø±Ù…Ø¶Ø§Ù† 1447 Ù… - Ø¬Ø§Ù…Ø¹ Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø±Ø¨ÙŠØ¹ Ø¨Ù† Ø­Ø¨ÙŠØ¨</h1>
    <h2>Ø§Ù„Ø³ÙŠØ¨ - ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù„ÙˆØ§Ù…ÙŠ</h2>

    <div style="overflow: auto">
      <table id="mainTable" aria-label="Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø±Ù…Ø¶Ø§Ù† ">
        <thead>
          <tr>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th>Ø§Ù„ÙˆÙ‚Øª</th>
            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
            <th>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<script>
const tbody = document.querySelector("#mainTable tbody");

function createRow(index) {
  const tr = document.createElement("tr");

  const startDate = new Date(2026, 1, 18);
  const currentDate = new Date(startDate);
  currentDate.setDate(startDate.getDate() + (index - 1));

  const day = currentDate.getDate();
  const month = currentDate.getMonth() + 1;
  const year = currentDate.getFullYear();

  const weekdays = ["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø§Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"];
  const weekdayName = weekdays[currentDate.getDay()];
  if (weekdayName === "Ø§Ù„Ø¬Ù…Ø¹Ø©") tr.classList.add("friday");

  // Ø§Ù„Ø¹Ù…ÙˆØ¯ 1: Ø§Ù„ØªØ§Ø±ÙŠØ®
  const tdDate = document.createElement("td");
  tdDate.contentEditable = "true";
  tdDate.dataset.row = index;
  tdDate.dataset.col = 1;
  tdDate.textContent = `${day}/${month}/${year} - ${weekdayName} - Ø±Ù…Ø¶Ø§Ù† ${index}`;
  tdDate.addEventListener("input", () => saveCell(index, 1, tdDate.textContent));
  tr.appendChild(tdDate);

  // Ø§Ù„Ø¹Ù…ÙˆØ¯ 2: Ø§Ù„ÙˆÙ‚Øª
  const tdTime = document.createElement("td");
  const selectTime = document.createElement("select");

  let options;
  if (weekdayName === "Ø§Ù„Ø¬Ù…Ø¹Ø©") {
    options = ["Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];
  } else {
    options = ["Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±","Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];
  }

  options.forEach(opt => {
    const option = document.createElement("option");
    option.value = opt;
    option.textContent = opt;
    if (loadCell(index, 2) === opt) option.selected = true;
    selectTime.appendChild(option);
  });

  selectTime.addEventListener("change", () => saveCell(index, 2, selectTime.value));
  tdTime.appendChild(selectTime);
  tr.appendChild(tdTime);

  // Ø§Ù„Ø¹Ù…ÙˆØ¯ 3: Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±
  const tdName = document.createElement("td");
  tdName.contentEditable = "true";
  tdName.dataset.row = index;
  tdName.dataset.col = 3;
  tdName.textContent = loadCell(index, 3) || "";
  tdName.addEventListener("input", () => saveCell(index, 3, tdName.textContent));
  tr.appendChild(tdName);

  // Ø§Ù„Ø¹Ù…ÙˆØ¯ 4: Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„
  const tdContact = document.createElement("td");
  tdContact.contentEditable = "true";
  tdContact.dataset.row = index;
  tdContact.dataset.col = 4;
  tdContact.textContent = loadCell(index, 4) || "";
  tdContact.addEventListener("input", () => saveCell(index, 4, tdContact.textContent));
  tr.appendChild(tdContact);

  return tr;
}

function populateInitialRows(n = 30) {
  tbody.innerHTML = "";
  for (let i = 1; i <= n; i++) tbody.appendChild(createRow(i));
}

populateInitialRows(30);

function saveCell(row, col, value) {
  localStorage.setItem(`cell_${row}_${col}`, value);
}

function loadCell(row, col) {
  return localStorage.getItem(`cell_${row}_${col}`);
}

// Ø²Ø± Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
document.getElementById("printBtn").addEventListener("click", () => {
  window.print();
});

// Ø²Ø± Ø§Ù„Ø­ÙØ¸ Ù…Ø¹ Ø¸Ù‡ÙˆØ± Ø±Ø³Ø§Ù„Ø©
document.getElementById("saveBtn").addEventListener("click", () => {
  const rows = tbody.querySelectorAll("tr");
  rows.forEach(tr => {
    tr.querySelectorAll("td").forEach(td => saveCell(td.dataset.row, td.dataset.col, td.textContent));
    const select = tr.querySelector("select");
    if (select) saveCell(tr.querySelector("td").dataset.row, 2, select.value);
  });

  const msg = document.getElementById("saveMessage");
  msg.style.display = "inline";
  setTimeout(() => { msg.style.display = "none"; }, 2000);
});
</script>
</body>
</html>
